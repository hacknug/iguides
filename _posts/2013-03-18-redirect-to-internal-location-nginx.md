---
layout: index
title: Редирект на внутренний location в nginx, или 418 Я - чайник
date: 2013-03-18 23:04
categories: [nginx, lulz]
---

Намедни удосужилось мне использовать этот [шуточный HTTP код][wiki]. Кто бы мог
подумать, что ему найдется реальное применение (пусть и не для приготовления
кофе).

Оказывается, не существует иного способа из обычного локэйшна в понятиях nginx
передать управление именованному, кроме как приведенный ниже хак. Раньше вроде
можно было сделать `try_files @location`, но у меня nginx ругается на
недостаточное количество аргументов директивы `try_files`.

Итак, хак:

```nginx

location @root {
    ...
}

location / {
    error_page 418 = @root; return 418; # redirect to @root
}

```

Да, вот так вот - присваиваем определенному коду ошибки обработчик в виде
именованного локэйшна, а затем генерируем ошибку с данным кодом. На
[форуме][forum] советуют использовать именно этот код, т. к. он, вероятно, не
пересечется ни с каким кодом, который может выкинуть приложение, а во-вторых,
"наиболее подходит по смыслу". Лол, что тут еще сказать? :D



[wiki]: http://ru.wikipedia.org/wiki/HTCPCP
[forum]: http://forum.nginx.org/read.php?21,172188
